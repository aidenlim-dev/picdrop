{% extends 'base.html' %}

{% block title %}{{ event.name }} - ê´€ë¦¬ - PicDrop{% endblock %}

{% block content %}
<div class="mb-8">
    <a href="{% url 'events:event_list' %}" class="text-indigo-600 hover:text-indigo-800 mb-4 inline-block">
        â† ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
    </a>
    
    <div class="flex items-start justify-between">
        <div>
            <h1 class="text-3xl font-bold text-gray-900 mb-2">{{ event.name }}</h1>
            <p class="text-gray-600">ğŸ“… {{ event.event_date|date:"Yë…„ mì›” dì¼" }}</p>
        </div>
        <a href="{% url 'admin:events_event_change' event.id %}" 
           class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors">
            âš™ï¸ ì„¤ì • ìˆ˜ì •
        </a>
    </div>
</div>

<!-- Stats & Links -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    <!-- Stats Card -->
    <div class="bg-white rounded-lg shadow-md p-6">
        <div class="text-4xl mb-2">ğŸ“·</div>
        <div class="text-3xl font-bold text-gray-900">{{ photos.count }}ì¥</div>
        <div class="text-gray-600">ì—…ë¡œë“œëœ ì‚¬ì§„</div>
    </div>
    
    <!-- Upload Link -->
    <div class="bg-green-50 rounded-lg shadow-md p-6">
        <div class="text-4xl mb-2">ğŸ“¤</div>
        <div class="text-sm font-medium text-gray-700 mb-2">ì—…ë¡œë“œ í˜ì´ì§€</div>
        <a href="{% url 'photos:upload' event.id %}" 
           target="_blank"
           class="text-green-600 hover:text-green-800 text-sm break-all">
            {{ request.scheme }}://{{ request.get_host }}{% url 'photos:upload' event.id %}
        </a>
    </div>
    
    <!-- Live Wall Link -->
    <div class="bg-indigo-50 rounded-lg shadow-md p-6">
        <div class="text-4xl mb-2">ğŸ¬</div>
        <div class="text-sm font-medium text-gray-700 mb-2">ë¼ì´ë¸Œ ì›”</div>
        <a href="{% url 'events:live_wall' event.id %}" 
           target="_blank"
           class="text-indigo-600 hover:text-indigo-800 text-sm break-all">
            {{ request.scheme }}://{{ request.get_host }}{% url 'events:live_wall' event.id %}
        </a>
    </div>
</div>

<!-- QR Code -->
{% if event.qr_code %}
<div class="bg-white rounded-lg shadow-md p-6 mb-8">
    <h2 class="text-xl font-bold text-gray-900 mb-4">QR ì½”ë“œ</h2>
    <div class="flex items-center space-x-8">
        <img src="{{ event.qr_code.url }}" alt="QR Code" class="w-64 h-64 border-4 border-gray-200 rounded-lg">
        <div>
            <p class="text-gray-700 mb-4">
                ì´ QR ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ë©´ ì‚¬ì§„ ì—…ë¡œë“œ í˜ì´ì§€ë¡œ ë°”ë¡œ ì´ë™í•©ë‹ˆë‹¤.<br>
                ì´ë²¤íŠ¸ í˜„ì¥ì— ì¸ì‡„í•˜ê±°ë‚˜ í™”ë©´ì— í‘œì‹œí•˜ì„¸ìš”.
            </p>
            <a href="{{ event.qr_code.url }}" 
               download="picdrop_qr_{{ event.name }}.png"
               class="inline-block bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700 transition-colors">
                ğŸ’¾ QR ì½”ë“œ ë‹¤ìš´ë¡œë“œ
            </a>
        </div>
    </div>
</div>
{% endif %}

<!-- Photos -->
<div class="bg-white rounded-lg shadow-md p-6">
    <h2 class="text-xl font-bold text-gray-900 mb-4">ì—…ë¡œë“œëœ ì‚¬ì§„ ({{ photos.count }}ì¥)</h2>
    
    {% if photos %}
    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
        {% for photo in photos %}
        <div class="relative group">
            <div class="aspect-square bg-gray-100 rounded-lg overflow-hidden">
                <img src="{{ photo.image.url }}" 
                     alt="Photo" 
                     class="w-full h-full object-cover">
            </div>
            
            <!-- Info & Delete -->
            <div class="absolute inset-0 bg-black/0 group-hover:bg-black/70 transition-all rounded-lg flex flex-col items-center justify-center opacity-0 group-hover:opacity-100 p-2">
                <div class="text-white text-xs text-center mb-2">
                    {% if photo.uploader_name %}
                    <p class="font-medium">{{ photo.uploader_name }}</p>
                    {% endif %}
                    <p>{{ photo.uploaded_at|date:"m/d H:i" }}</p>
                </div>
                <form method="post" action="{% url 'events:delete_photo' event.id photo.id %}" 
                      onsubmit="return confirm('ì´ ì‚¬ì§„ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">
                    {% csrf_token %}
                    <button type="submit" 
                            class="bg-red-500 text-white px-3 py-1 rounded text-xs hover:bg-red-600 transition-colors">
                        ğŸ—‘ï¸ ì‚­ì œ
                    </button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-12 text-gray-500">
        <div class="text-6xl mb-4">ğŸ“¸</div>
        <p>ì•„ì§ ì—…ë¡œë“œëœ ì‚¬ì§„ì´ ì—†ìŠµë‹ˆë‹¤</p>
    </div>
    {% endif %}
</div>
{% endblock %}
